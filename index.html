<!DOCTYPE html>
<html lang="en">
  <head>
    <meta
      name="viewport"
      content="width=device-width, height=device-height,initial-scale=1, minimum-scale=1, maximum-scale=1"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Kanit:wght@300&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
    <!-- Include the ECharts file you just downloaded -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>

    <style>
      * {
        font-family: "Kanit", sans-serif;
      }

      .main-detail {
        margin: 1rem 1rem 3rem 1rem;
        padding: 2rem 1.5rem;
        width: 650px;
        justify-content: center;
        border: 1px solid rgb(120, 118, 118);
        border-radius: 10px;
      }

      .detail {
        width: 100%;
      }

      .machine-list li.machine-active {
        background-color: hsla(240, 0%, 56%, 0.897);
      }

      .machine-list ul {
        padding: 0;
        display: grid;
        grid-template-columns: auto auto auto;
        gap: 15px;
      }

      .machine-list li {
        cursor: pointer;
        list-style-type: none;
        background-color: blue;
        padding: 8px 12px;
        border-radius: 10px;
        color: #fff;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-dark bg-primary p-1 fixed-top">
      <div class="container-fluid">
        <a class="navbar-brand fs-3 text-white text-center"
          >IOT เครื่องนับแผงยา</a
        >
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasNavbar"
          aria-controls="offcanvasNavbar"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="offcanvas offcanvas-end"
          tabindex="-1"
          id="offcanvasNavbar"
          aria-labelledby="offcanvasNavbarLabel"
        >
          <div class="offcanvas-header">
            <h5 class="offcanvas-title pb-0" id="offcanvasNavbarLabel">
              รายชื่อเครื่องจักร
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="offcanvas"
              aria-label="Close"
            ></button>
          </div>
          <div class="offcanvas-body machine-list">
            <ul>
              <li data-machineName="Strip2" class="machine-active">
                Strip2 <br />(รหัส 20102)
              </li>
              <li data-machineName="Strip3">Strip3 <br />(รหัส 20103)</li>
              <li data-machineName="Strip4">Strip4 <br />(รหัส 20104)</li>
              <li data-machineName="Strip5">Strip5 <br />(รหัส 20105)</li>
              <li data-machineName="Strip6">Strip6 <br />(รหัส 20106)</li>
              <li data-machineName="Blister1">Blister1 <br />(รหัส 20201)</li>
              <li data-machineName="Blister2">Blister2 <br />(รหัส 20202)</li>
              <li data-machineName="Blister3">Blister3 <br />(รหัส 20203)</li>
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <div class="mt-5 pt-5">
      <div
        class="mx-5 my-3 py-1 fs-4 bg-success rounded text-center text-white"
      >
        เครื่อง Strip2
      </div>
      <div id="main" style="width: 100%; height: 400px"></div>
      <div class="d-flex justify-content-center">
        <div
          class="mx-3 my-3 py-2 px-5 fs-6 bg-secondary rounded text-center text-white"
        >
          ข้อมูลล่าสุด 22/06/2023, 23:42:45
        </div>
      </div>
      <div class="container d-flex justify-content-center">
        <div class="main-detail d-grid gap-3">
          <div class="detail text-center pb-2">
            <div>
              <p class="lead">จำนวนชิ้นงานทั้งหมด</p>
              <h3 class="display-4">4,704 ชิ้น</h3>
              <p class="lead">จากเป้า 10,000 ชิ้น</p>
            </div>
          </div>
          <div class="detail">
            <li>ชื่อยา AMCO</li>
            <li>เลขที่ผลิต: 10540</li>
            <li>เวลาผ่านไปแล้วในกะนี้: 00 ชั่วโมง 13 นาที</li>
            <li>คลาดว่าจะเสร็จในอีก (โดยประมาณ): 05 ชั่วโมง 13 นาที</li>
            <li>เฉลี่ย 50 ชิ้น ต่อ นาที</li>
          </div>
        </div>
      </div>
    </div>

    <script type="text/javascript">
      // Initialize the echarts instance based on the prepared dom
      let data = [
        56, 58, 60, 45, 35, 75, 32, 45, 20, 15, 42, 35, 56, 58, 60, 45, 35, 75,
        32, 45, 20, 15, 42, 35, 56, 58, 60, 45, 35, 75, 32, 45, 20, 15, 42, 35,
        56, 58, 60, 45, 35, 75, 32, 45, 20, 15, 42, 35, 56, 58, 60, 45, 35, 75,
        32, 45, 20, 15, 42, 35, 56, 58, 60, 45, 35, 75, 32, 45, 20, 15, 42, 35,
        56, 58, 60, 45, 35, 75, 32, 45, 20, 15, 42, 35, 56, 58, 60, 45, 35, 75,
        32, 45, 20, 15, 42, 35, 56, 58, 60, 45, 35, 75, 32, 45, 20, 15, 42, 35,
      ];
      let name = [];
      let dataB = [];

      let sum = 0;
      for (let i = 0; i < data.length; i++) {
        sum += data[i];
        name.push(`22/06/2023, 23:${i}:40`.replace(" ", "\n"));
        dataB.push(sum);
      }

      var myChart = echarts.init(document.getElementById("main"));

      // Specify the configuration items and data for the chart
      var option = {
        dataZoom: [
          {
            type: "inside",
          },
        ],
        tooltip: {
          trigger: "axis",
          axisPointer: {
            type: "cross",
            crossStyle: {
              color: "#999",
            },
          },
        },
        toolbox: {
          feature: {
            dataView: { show: true, readOnly: false },
            magicType: { show: true, type: ["line", "bar"] },
            restore: { show: true },
            saveAsImage: { show: true },
          },
          width: "100%",
          left: "43%",
        },
        legend: {
          data: ["Precipitation", "Temperature"],
          textStyle: {
            fontFamily: "Kanit",
          },
        },
        xAxis: [
          {
            type: "category",
            data: name,
            axisPointer: {
              type: "shadow",
            },
          },
        ],
        yAxis: [
          {
            type: "value",
            name: "จำนวน",
            min: 0,
            max: Math.max(...data) + 50,
          },
          {
            type: "value",
            name: "จำนวนสะสม",
            min: 0,
            max: Math.max(...dataB),
            type: "value",
            boundaryGap: [0, "100%"],
            splitLine: {
              show: false,
            },
          },
        ],
        series: [
          {
            name: "จำนวน",
            type: "bar",
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                { offset: 0, color: "#83bff6" },
                { offset: 0.9, color: "#188df0" },
                { offset: 1, color: "#188df0" },
              ]),
            },
            tooltip: {
              valueFormatter: function (value) {
                return value;
              },
            },
            data: data,
          },
          {
            name: "จำนวนสะสม",
            type: "line",
            yAxisIndex: 1,
            symbol: "none",
            lineStyle: {
              color: "red",
              width: 1,
            },
            tooltip: {
              valueFormatter: function (value) {
                return value;
              },
            },
            data: dataB,
          },
        ],
      };

      // Display the chart using the configuration items and data just specified.
      myChart.setOption(option);

      window.addEventListener("resize", function () {
        myChart.resize();
      });
    </script>

    <script>
      const offcanvasEl = new bootstrap.Offcanvas("#offcanvasNavbar");
      const listItems = document.querySelectorAll("li");
      let machineName;
      listItems.forEach((item) => {
        item.addEventListener("click", () => {
          offcanvasEl.hide();
          event_machineName = item.getAttribute("data-machineName");
          if (event_machineName != machineName) {
            machineName = item.getAttribute("data-machineName");
            console.log(machineName);
          }

          listItems.forEach((li) => {
            li.classList.remove("machine-active");
          });
          item.classList.add("machine-active");
        });
      });
    </script>
  </body>
</html>
